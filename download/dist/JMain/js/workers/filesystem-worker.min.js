self.requestFileSystemSync=self.webkitRequestFileSystemSync||self.requestFileSystemSync,self.importScripts('requester-tools.js'),self.requester={},function(){var g={SIZEFILES:10485760,READ:{create:0},WRITE:{create:1}},h=null;self.requestFileSystemSync&&(h=h||self.requestFileSystemSync(TEMPORARY,g.SIZEFILES)),self.tools.factoryError((function(){})),this.getFile=function(e){try{if(!e.cache||!h)return self.tools.send(e);e.update=!0;var a=h.root.getFile(e.name,g.READ);return e.blob=a.file(),!isNaN(e.jdate)&&e.jdate>Date.parse(e.blob.lastModifiedDate)?self.tools.send(e):(e.update=!1,self.tools.getObject(e))}catch(b){if(-1<b.toString().indexOf('NotFoundError'))return self.tools.send(e);self.tools.error(b,e.name)}},this.save=function(a,b){var c=b.clone();return c.blob().then((function(b){var c,d=h.root.getFile(a.name,g.WRITE);return d.remove(),d=h.root.getFile(a.name,g.WRITE),c=d.createWriter(),c.write(b),b})).catch(self.tools.error)},this.removeAll=function(){var b=h.root.createReader(),a=b.readEntries();for(var c in a)a[c].remove()}}.apply(self.requester),self.addEventListener('message',(function(c){var a=c.data;a.getFile=self.requester.getFile,a.save=self.requester.save;try{self.tools.get(c.data).then(self.postMessage).catch(self.tools.error)}catch(b){self.tools.error(b)}}));